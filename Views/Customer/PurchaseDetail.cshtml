@model IEnumerable<OrderDetail>
<h2 class="mt-3"><i class="fa-solid fa-address-card"></i> Purchase Details</h2>

@* <table class="table table-hover">
  <thead>
    <tr>
      <th scope="col">
        <div class="form-row">
          <div class="form-group col-md-8 mb-0">
            <select class="form-control form-control-sm" id="CategoryId">
            @foreach (OrderDetail o in Model)
            {
              if (o.OrderId == ViewBag.id)
                { <option value="@o.OrderId" selected>@o.OrderId</option> }
              else
                { <option value="@o.OrderId">@o.OrderId</option> }
            }
            </select>
          </div>
          <div class="form-group col-md-4 mb-0">
            <div class="form-check text-right">
              <input class="form-check-input" type="checkbox" id="Discontinued">
              <label class="form-check-label" for="Discontinued">Discontinued</label>
            </div>
          </div>
      </div>
      </th>
      <th scope="col" class="text-right">Price ($)</th>
      <th scope="col" class="text-right">Stock</th>
      <th scope="col" class="text-right">Rating</th>
    </tr>
</thead>
<tbody id="product_rows" data-id="@ViewBag.id"></tbody>
</table> *@

<div class="list-group">
    @foreach (OrderDetail od in Model)
    {
        <a asp-action="PurchaseDetails" asp-route-id="@od.ProductId" class="list-group-item list-group-item-action">@od.OrderId - ORDER DATE: @od.Product.ProductName - SHIPPED DATE: @od.Quantity</a>
    }
</div>

@* @section Scripts
{
  <script>
  $(function () {
    getProducts()
    function getProducts() {
      var discontinued = $('#Discontinued').prop('checked') ? "" : "/discontinued/false";
      $.getJSON({
        url: `../../api/category/${$('#product_rows').data('id')}/product` + discontinued,
        success: function (response, textStatus, jqXhr) {
          $('#product_rows').html("");
            for (var i = 0; i < response.length; i++){
              var css = response[i].discontinued ? " class='discontinued'" : "";
              var rating = '<i class="fa-sharp fa-solid fa-star"></i><i class="fa-sharp fa-solid fa-star"></i><i class="fa-sharp fa-solid fa-star"></i><i class="fa-sharp fa-solid fa-star"></i><i class="fa-sharp fa-regular fa-star"></i>';
              var row = `<tr${css}>
                <td>${response[i].productName}</td>
                <td class="text-right">${response[i].unitPrice.toFixed(2)}</td>
                <td class="text-right">${response[i].unitsInStock}</td>
                <td class="text-right">${rating}</td>
                </tr>`;
              $('#product_rows').append(row);
            }
        },
        error: function (jqXHR, textStatus, errorThrown) {
          // log the error to the console
          console.log("The following error occured: " + textStatus, errorThrown);
        }
      });
    }
    $('#CategoryId').on('change', function(){
      $('#product_rows').data('id', $(this).val());
      getProducts();
    });
    $('#Discontinued').on('change', function(){
      getProducts();
    });
  });
  </script>
} *@